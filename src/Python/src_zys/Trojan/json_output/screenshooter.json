"Module(body=[Import(names=[alias(name='base64')]), Import(names=[alias(name='win32api')]), Import(names=[alias(name='win32con')]), Import(names=[alias(name='win32gui')]), Import(names=[alias(name='win32ui')]), FunctionDef(name='get_dimensions', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='width', ctx=Store())], value=Call(func=Attribute(value=Name(id='win32api', ctx=Load()), attr='GetSystemMetrics', ctx=Load()), args=[Attribute(value=Name(id='win32con', ctx=Load()), attr='SM_CXVIRTUALSCREEN', ctx=Load())], keywords=[])), Assign(targets=[Name(id='height', ctx=Store())], value=Call(func=Attribute(value=Name(id='win32api', ctx=Load()), attr='GetSystemMetrics', ctx=Load()), args=[Attribute(value=Name(id='win32con', ctx=Load()), attr='SM_CYVIRTUALSCREEN', ctx=Load())], keywords=[])), Assign(targets=[Name(id='left', ctx=Store())], value=Call(func=Attribute(value=Name(id='win32api', ctx=Load()), attr='GetSystemMetrics', ctx=Load()), args=[Attribute(value=Name(id='win32con', ctx=Load()), attr='SM_XVIRTUALSCREEN', ctx=Load())], keywords=[])), Assign(targets=[Name(id='top', ctx=Store())], value=Call(func=Attribute(value=Name(id='win32api', ctx=Load()), attr='GetSystemMetrics', ctx=Load()), args=[Attribute(value=Name(id='win32con', ctx=Load()), attr='SM_YVIRTUALSCREEN', ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Name(id='width', ctx=Load()), Name(id='height', ctx=Load()), Name(id='left', ctx=Load()), Name(id='top', ctx=Load())], ctx=Load()))], decorator_list=[]), FunctionDef(name='screenshot', args=arguments(posonlyargs=[], args=[arg(arg='name')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='screenshot')]), body=[Assign(targets=[Name(id='hdesktop', ctx=Store())], value=Call(func=Attribute(value=Name(id='win32gui', ctx=Load()), attr='GetDesktopWindow', ctx=Load()), args=[], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='width', ctx=Store()), Name(id='height', ctx=Store()), Name(id='left', ctx=Store()), Name(id='top', ctx=Store())], ctx=Store())], value=Call(func=Name(id='get_dimensions', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='desktop_dc', ctx=Store())], value=Call(func=Attribute(value=Name(id='win32gui', ctx=Load()), attr='GetWindowDC', ctx=Load()), args=[Name(id='hdesktop', ctx=Load())], keywords=[])), Assign(targets=[Name(id='img_dc', ctx=Store())], value=Call(func=Attribute(value=Name(id='win32ui', ctx=Load()), attr='CreateDCFromHandle', ctx=Load()), args=[Name(id='desktop_dc', ctx=Load())], keywords=[])), Assign(targets=[Name(id='mem_dc', ctx=Store())], value=Call(func=Attribute(value=Name(id='img_dc', ctx=Load()), attr='CreateCompatibleDC', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='screenshot', ctx=Store())], value=Call(func=Attribute(value=Name(id='win32ui', ctx=Load()), attr='CreateBitmap', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='screenshot', ctx=Load()), attr='CreateCompatibleBitmap', ctx=Load()), args=[Name(id='img_dc', ctx=Load()), Name(id='width', ctx=Load()), Name(id='height', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='mem_dc', ctx=Load()), attr='SelectObject', ctx=Load()), args=[Name(id='screenshot', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='mem_dc', ctx=Load()), attr='BitBlt', ctx=Load()), args=[Tuple(elts=[Constant(value=0), Constant(value=0)], ctx=Load()), Tuple(elts=[Name(id='width', ctx=Load()), Name(id='height', ctx=Load())], ctx=Load()), Name(id='img_dc', ctx=Load()), Tuple(elts=[Name(id='left', ctx=Load()), Name(id='top', ctx=Load())], ctx=Load()), Attribute(value=Name(id='win32con', ctx=Load()), attr='SRCCOPY', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='screenshot', ctx=Load()), attr='SaveBitmapFile', ctx=Load()), args=[Name(id='mem_dc', ctx=Load()), JoinedStr(values=[FormattedValue(value=Name(id='name', ctx=Load()), conversion=-1), Constant(value='.bmp')])], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='mem_dc', ctx=Load()), attr='DeleteDC', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='win32gui', ctx=Load()), attr='DeleteObject', ctx=Load()), args=[Call(func=Attribute(value=Name(id='screenshot', ctx=Load()), attr='GetHandle', ctx=Load()), args=[], keywords=[])], keywords=[]))], decorator_list=[]), FunctionDef(name='run', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Name(id='screenshot', ctx=Load()), args=[], keywords=[])), With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Constant(value='screenshot.bmp')], keywords=[]), optional_vars=Name(id='f', ctx=Store()))], body=[Assign(targets=[Name(id='img', ctx=Store())], value=Call(func=Attribute(value=Name(id='f', ctx=Load()), attr='read', ctx=Load()), args=[], keywords=[])), Return(value=Name(id='img', ctx=Load()))])], decorator_list=[]), If(test=Compare(left=Name(id='__name__', ctx=Load()), ops=[Eq()], comparators=[Constant(value='__main__')]), body=[Expr(value=Call(func=Name(id='screenshot', ctx=Load()), args=[], keywords=[]))], orelse=[])], type_ignores=[])"